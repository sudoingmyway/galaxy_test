---
- name: Smoke test for EL_Gitleaks role
  hosts: localhost
  connection: local
  become: true
  vars:
    gitleaks_version: "8.25.0"
    configure_offline: false
  roles:
    - role: ../../../EL_Gitleaks

  tasks:
    - name: Check Gitleaks version
      command: /usr/local/bin/gitleaks --version
      register: result
      changed_when: false
      failed_when: "'{{ gitleaks_version }}' not in result.stdout"

    - name: Print installed version
      debug:
        var: result.stdout